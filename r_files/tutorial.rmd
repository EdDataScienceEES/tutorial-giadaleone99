---
title: "Tutorial"
author: "Giada Leone"
date: "14/11/2021"
output:
  html_document: default
  pdf_document: default
---

# Creating **static and interactive** maps in R for beginners

This tutorial is aimed at people who have little experience in using R and would like to try **spatial data visualisation** by using R as a GIS like software using specific packages.

R is very powerful due to its wide applications in statistics, modelling, data visualisation and spatial data. In this tutorial we will be focussing on spatial data and different ways to visualise it.

### Tutorial Aims:
1. Data preparation and wrangling for spatial visualisation
2. Creating basic maps using ggplot2
3. Creating interactive maps using the mapview package
4. ...

These are the libraries we need to load. 

We will be using the ```tidyverse``` to do data wrangling and preparing the dataset, it also includes the ```ggplot2``` package which can be used for visualisation.

The ```janitor``` package is a useful tool to clean datasets which will come in handy when handling public datasets which may be messy.

If you have any troubles installing the ```sf``` package you can check out this link for suggestions: https://r-spatial.github.io/sf/ 

The package ```mapview```

If you have never used these packages before you will need to install them by using the ```install.packages("packagename")``` function and include all the names within the "" before loading them with the ```library(packagename)``` function.
```{r, warning=FALSE, message=FALSE}
# Libraries ----
# install.packages("tidyverse")
   
library(tidyverse)  # Data wrangling & includes ggplot2
library(janitor)    # Cleaning datasets
library(ggthemes)   # Themes for ggplot2
library(sf)         # 
library(mapview)    # Interactive maps
```

Downloading and importing the dataset

To download the dataset you can clone or download the repository to your computer and find the 'beachwatch_data.csv' within the 'data' folder. To download the repository click [here](https://github.com/EdDataScienceEES/tutorial-giadaleone99) and click on the green 'Code' button and then click on 'download ZIP'. Next you can unzip the folder and move the data files where you need them.


Here we are importing a comma separated value (.csv) file using the ```read.csv()``` function and assigning it to an object called 'beaches'. 

```{r}
beaches <- read.csv("../data/beachwatch_data.csv", header = TRUE)
str(beaches)  # Checking data structure
```

Preparing the data
```{r}
# cleaning data frame column names
beaches <- beaches %>% clean_names() 

# deleting unused columns
beaches <- select(beaches,-seq(12, 109), -seq(112, 170))  

# dropping columns which have NA values
beaches <- drop_na(beaches)  

```

Changing data type

```{r}
beaches <- beaches %>% mutate_if(is.character, as.factor) %>% 
                       mutate_if(is.integer, as.numeric)

```


Let's use ggplot to create a map to show us all the beaches around the UK which have data from Great British Beach Clean surveys. 

Creating a basic map in ggplot2







Here we specify the coordinates (longitude and latitude) of our points within the ```aes()``` function and we also tell ggplot to colour the points depending on beach region.





```{r}
(map <- ggplot(beaches,
               aes(x = beach_longitude,
                   y = beach_latitude, 
                   colour = beach_region)) +
   borders("world", colour = "grey5", fill = "black", size = 0.2) +
   coord_cartesian(xlim = c(-10, 3), ylim = c(50.3, 59)) +
   theme_map() +
   geom_point(size = 1) +
   theme(plot.title = element_text(size = 12, hjust = 0.5),
         legend.position = c(0.77, 0.4),
         legend.box.background = element_rect(color = 'grey', size = 0.5)) +
   labs(title = "Beach Locations by Region",
        colour = "UK Regions"))
```










Spatial analysis 
```{r}
beaches_obj <- st_as_sf(beaches, coords =  c('beach_longitude', 'beach_latitude'), crs = 4326)

# examine the sf object
beaches_obj
str(beaches_obj)

plot(beaches_obj)

plot(st_geometry(beaches_obj))
```

Interactive map 
```{r}
mapview(beaches_obj, zcol = 'beach_region')
```
